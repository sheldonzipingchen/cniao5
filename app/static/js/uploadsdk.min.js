/** 
 * -------------------------------------------------------------
 * Copyright (c) 2014 baofeng, All rights reserved. 
 * http://www.baofeng.com/ 
 *  
 * @version: 0.0.1 
 * @author: ningxiao <363305175@qq.com> 
 * @description: clouds-app 
 * @date: 2015-07-21  14:17:16
 * ------------------------------------------------------------- 
 */

function hex_md5(a){return binl2hex(core_md5(str2binl(a),a.length*chrsz))}function b64_md5(a){return binl2b64(core_md5(str2binl(a),a.length*chrsz))}function str_md5(a){return binl2str(core_md5(str2binl(a),a.length*chrsz))}function hex_hmac_md5(a,b){return binl2hex(core_hmac_md5(a,b))}function b64_hmac_md5(a,b){return binl2b64(core_hmac_md5(a,b))}function str_hmac_md5(a,b){return binl2str(core_hmac_md5(a,b))}function md5_vm_test(){return"900150983cd24fb0d6963f7d28e17f72"==hex_md5("abc")}function core_md5(a,b){a[b>>5]|=128<<b%32,a[(b+64>>>9<<4)+14]=b;for(var c=1732584193,d=-271733879,e=-1732584194,f=271733878,g=0;g<a.length;g+=16){var h=c,i=d,j=e,k=f;c=md5_ff(c,d,e,f,a[g+0],7,-680876936),f=md5_ff(f,c,d,e,a[g+1],12,-389564586),e=md5_ff(e,f,c,d,a[g+2],17,606105819),d=md5_ff(d,e,f,c,a[g+3],22,-1044525330),c=md5_ff(c,d,e,f,a[g+4],7,-176418897),f=md5_ff(f,c,d,e,a[g+5],12,1200080426),e=md5_ff(e,f,c,d,a[g+6],17,-1473231341),d=md5_ff(d,e,f,c,a[g+7],22,-45705983),c=md5_ff(c,d,e,f,a[g+8],7,1770035416),f=md5_ff(f,c,d,e,a[g+9],12,-1958414417),e=md5_ff(e,f,c,d,a[g+10],17,-42063),d=md5_ff(d,e,f,c,a[g+11],22,-1990404162),c=md5_ff(c,d,e,f,a[g+12],7,1804603682),f=md5_ff(f,c,d,e,a[g+13],12,-40341101),e=md5_ff(e,f,c,d,a[g+14],17,-1502002290),d=md5_ff(d,e,f,c,a[g+15],22,1236535329),c=md5_gg(c,d,e,f,a[g+1],5,-165796510),f=md5_gg(f,c,d,e,a[g+6],9,-1069501632),e=md5_gg(e,f,c,d,a[g+11],14,643717713),d=md5_gg(d,e,f,c,a[g+0],20,-373897302),c=md5_gg(c,d,e,f,a[g+5],5,-701558691),f=md5_gg(f,c,d,e,a[g+10],9,38016083),e=md5_gg(e,f,c,d,a[g+15],14,-660478335),d=md5_gg(d,e,f,c,a[g+4],20,-405537848),c=md5_gg(c,d,e,f,a[g+9],5,568446438),f=md5_gg(f,c,d,e,a[g+14],9,-1019803690),e=md5_gg(e,f,c,d,a[g+3],14,-187363961),d=md5_gg(d,e,f,c,a[g+8],20,1163531501),c=md5_gg(c,d,e,f,a[g+13],5,-1444681467),f=md5_gg(f,c,d,e,a[g+2],9,-51403784),e=md5_gg(e,f,c,d,a[g+7],14,1735328473),d=md5_gg(d,e,f,c,a[g+12],20,-1926607734),c=md5_hh(c,d,e,f,a[g+5],4,-378558),f=md5_hh(f,c,d,e,a[g+8],11,-2022574463),e=md5_hh(e,f,c,d,a[g+11],16,1839030562),d=md5_hh(d,e,f,c,a[g+14],23,-35309556),c=md5_hh(c,d,e,f,a[g+1],4,-1530992060),f=md5_hh(f,c,d,e,a[g+4],11,1272893353),e=md5_hh(e,f,c,d,a[g+7],16,-155497632),d=md5_hh(d,e,f,c,a[g+10],23,-1094730640),c=md5_hh(c,d,e,f,a[g+13],4,681279174),f=md5_hh(f,c,d,e,a[g+0],11,-358537222),e=md5_hh(e,f,c,d,a[g+3],16,-722521979),d=md5_hh(d,e,f,c,a[g+6],23,76029189),c=md5_hh(c,d,e,f,a[g+9],4,-640364487),f=md5_hh(f,c,d,e,a[g+12],11,-421815835),e=md5_hh(e,f,c,d,a[g+15],16,530742520),d=md5_hh(d,e,f,c,a[g+2],23,-995338651),c=md5_ii(c,d,e,f,a[g+0],6,-198630844),f=md5_ii(f,c,d,e,a[g+7],10,1126891415),e=md5_ii(e,f,c,d,a[g+14],15,-1416354905),d=md5_ii(d,e,f,c,a[g+5],21,-57434055),c=md5_ii(c,d,e,f,a[g+12],6,1700485571),f=md5_ii(f,c,d,e,a[g+3],10,-1894986606),e=md5_ii(e,f,c,d,a[g+10],15,-1051523),d=md5_ii(d,e,f,c,a[g+1],21,-2054922799),c=md5_ii(c,d,e,f,a[g+8],6,1873313359),f=md5_ii(f,c,d,e,a[g+15],10,-30611744),e=md5_ii(e,f,c,d,a[g+6],15,-1560198380),d=md5_ii(d,e,f,c,a[g+13],21,1309151649),c=md5_ii(c,d,e,f,a[g+4],6,-145523070),f=md5_ii(f,c,d,e,a[g+11],10,-1120210379),e=md5_ii(e,f,c,d,a[g+2],15,718787259),d=md5_ii(d,e,f,c,a[g+9],21,-343485551),c=safe_add(c,h),d=safe_add(d,i),e=safe_add(e,j),f=safe_add(f,k)}return Array(c,d,e,f)}function md5_cmn(a,b,c,d,e,f){return safe_add(bit_rol(safe_add(safe_add(b,a),safe_add(d,f)),e),c)}function md5_ff(a,b,c,d,e,f,g){return md5_cmn(b&c|~b&d,a,b,e,f,g)}function md5_gg(a,b,c,d,e,f,g){return md5_cmn(b&d|c&~d,a,b,e,f,g)}function md5_hh(a,b,c,d,e,f,g){return md5_cmn(b^c^d,a,b,e,f,g)}function md5_ii(a,b,c,d,e,f,g){return md5_cmn(c^(b|~d),a,b,e,f,g)}function core_hmac_md5(a,b){var c=str2binl(a);c.length>16&&(c=core_md5(c,a.length*chrsz));for(var d=Array(16),e=Array(16),f=0;16>f;f++)d[f]=909522486^c[f],e[f]=1549556828^c[f];var g=core_md5(d.concat(str2binl(b)),512+b.length*chrsz);return core_md5(e.concat(g),640)}function safe_add(a,b){var c=(65535&a)+(65535&b),d=(a>>16)+(b>>16)+(c>>16);return d<<16|65535&c}function bit_rol(a,b){return a<<b|a>>>32-b}function str2binl(a){for(var b=Array(),c=(1<<chrsz)-1,d=0;d<a.length*chrsz;d+=chrsz)b[d>>5]|=(a.charCodeAt(d/chrsz)&c)<<d%32;return b}function binl2str(a){for(var b="",c=(1<<chrsz)-1,d=0;d<32*a.length;d+=chrsz)b+=String.fromCharCode(a[d>>5]>>>d%32&c);return b}function binl2hex(a){for(var b=hexcase?"0123456789ABCDEF":"0123456789abcdef",c="",d=0;d<4*a.length;d++)c+=b.charAt(a[d>>2]>>d%4*8+4&15)+b.charAt(a[d>>2]>>d%4*8&15);return c}function binl2b64(a){for(var b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c="",d=0;d<4*a.length;d+=3)for(var e=(a[d>>2]>>8*(d%4)&255)<<16|(a[d+1>>2]>>8*((d+1)%4)&255)<<8|a[d+2>>2]>>8*((d+2)%4)&255,f=0;4>f;f++)c+=8*d+6*f>32*a.length?b64pad:b.charAt(e>>6*(3-f)&63);return c}var hexcase=0,b64pad="",chrsz=8;"object"!=typeof JSON&&(JSON={}),function(){"use strict";function f(a){return 10>a?"0"+a:a}function this_value(){return this.valueOf()}function quote(a){return rx_escapable.lastIndex=0,rx_escapable.test(a)?'"'+a.replace(rx_escapable,function(a){var b=meta[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(a,b){var c,d,e,f,g,h=gap,i=b[a];switch(i&&"object"==typeof i&&"function"==typeof i.toJSON&&(i=i.toJSON(a)),"function"==typeof rep&&(i=rep.call(b,a,i)),typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";if(gap+=indent,g=[],"[object Array]"===Object.prototype.toString.apply(i)){for(f=i.length,c=0;f>c;c+=1)g[c]=str(c,i)||"null";return e=0===g.length?"[]":gap?"[\n"+gap+g.join(",\n"+gap)+"\n"+h+"]":"["+g.join(",")+"]",gap=h,e}if(rep&&"object"==typeof rep)for(f=rep.length,c=0;f>c;c+=1)"string"==typeof rep[c]&&(d=rep[c],e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));else for(d in i)Object.prototype.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));return e=0===g.length?"{}":gap?"{\n"+gap+g.join(",\n"+gap)+"\n"+h+"}":"{"+g.join(",")+"}",gap=h,e}}var rx_one=/^[\],:{}\s]*$/,rx_two=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,rx_three=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,rx_four=/(?:^|:|,)(?:\s*\[)+/g,rx_escapable=/[\\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,rx_dangerous=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},Boolean.prototype.toJSON=this_value,Number.prototype.toJSON=this_value,String.prototype.toJSON=this_value);var gap,indent,meta,rep;"function"!=typeof JSON.stringify&&(meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(a,b,c){var d;if(gap="",indent="","number"==typeof c)for(d=0;c>d;d+=1)indent+=" ";else"string"==typeof c&&(indent=c);if(rep=b,b&&"function"!=typeof b&&("object"!=typeof b||"number"!=typeof b.length))throw new Error("JSON.stringify");return str("",{"":a})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&"object"==typeof e)for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=walk(e,c),void 0!==d?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;if(text=String(text),rx_dangerous.lastIndex=0,rx_dangerous.test(text)&&(text=text.replace(rx_dangerous,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),rx_one.test(text.replace(rx_two,"@").replace(rx_three,"]").replace(rx_four,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}();var clouds=clouds||{};clouds.utils={xmlHttp:null,createXMLHttpRequest:function(){window.ActiveXObject?this.xmlHttp=new ActiveXObject("Microsoft.XMLHTTP"):window.XMLHttpRequest&&(this.xmlHttp=new XMLHttpRequest)},createURL:function(a,b,c,d,e,f){var g,h=!1,i=-1!=a.indexOf(".xml");e=e||"GET",f=f||8e3,g=setTimeout(function(){h=!0,d()},f),this.createXMLHttpRequest(),this.xmlHttp.onreadystatechange=function(){4==this.readyState&&(200==this.status?(clearTimeout(g),c&&!h&&(b=i?this.responseXML:JSON.parse(this.responseText),c(b))):h||(clearTimeout(g),d()))},"GET"==e?(a=this.analyzetpl(a,b),b=null):b=JSON.stringify(b),this.xmlHttp.open(e,a,"true"),this.xmlHttp.send(b)},provide:function(a){for(var b=a.split("."),c=window,d=0,e=b.length;e>d;d++)c=c[b[d]]?c[b[d]]:c[b[d]]=new Object},bind:function(a,b){return a.bind?a.bind(b):function(){a.apply(b,arguments)}},jsontourl:function(a){var b=[];if(a)for(var c in a)b.push(c+"="+a[c]);return b.join("&")},charlen:function(a){return a?a.replace(/[^\x00-\xff]/g,"xx").length:0},inherits:function(a,b){a.prototype=new b,a.prototype.constructor=a},analyzetpl:function(a,b){return b?a.replace(/\{(.*?)\}/gi,function(){return"undefined"==typeof b[arguments[1]]?"":b[arguments[1]]}):a},enginetpl:function(a,b){for(var c,d=/<%(.+?)%>/g,e=/(^( )?(var|if|for|else|switch|case|break|{|}|;))(.*)?/g,f="with(obj) { var r=[];\n",g=0,h=function(a,b){return f+=b?a.match(e)?a+"\n":"r.push("+a+");\n":""!=a?'r.push("'+a.replace(/"/g,'\\"')+'");\n':"",h};match=d.exec(a);)h(a.slice(g,match.index))(match[1],!0),g=match.index+match[0].length;h(a.substr(g,a.length-g)),f=(f+'return r.join(""); }').replace(/[\r\t\n]/g,"");try{c=new Function("obj",f).apply(b,[b])}catch(i){console.error("'"+i.message+"'"," in \n\nCode:\n",f,"\n")}return c},sizechange:function(a){return a/=1048576,parseInt(a)>0?a.toFixed(1)+"MB":a.toFixed(3)+"MB"},locationjson:function(a,b){var c,d,e;if(a){e={},c=a.split("&");for(var f=0,g=c.length;g>f;f++)d=c[f].split("="),e[d[0]]=d[1];if(!b)return e}return e&&b&&b in e?e[b]:null},numFormat:function(a){return a=parseInt(a),10>a?"0"+a:a},getType:function(a){return Object.prototype.toString.call(a).match(/^\[object\s(.*)\]$/)[1]},ajax:function(a,b,c,d,e,f){var g=new XMLHttpRequest;if(g.upload){if(g.onreadystatechange=function(a){4==g.readyState&&308==g.status&&c(g.responseText)},g.upload.onerror=g.upload.ontimeout=d,g.timeout=f||3e3,g.withCredentials=!1,g.open("POST",a,!0),e)for(var h in e)g.setRequestHeader(h,e[h]);g.send(b||null)}},getSwf:function(a){var b,c,d=document.getElementById(a)||null;return d&&"OBJECT"==d.nodeName.toUpperCase()&&("undefined"!=typeof d.SetVariable?b=d:(c=d.getElementsByTagName("embed")[0],c&&(b=c))),b},timeFormat:function(a){var b="";a=Math.floor(a/1e3);var c=a%60;return b=c>9?":"+c:":0"+c,a=Math.floor(a/60),c=a%60,b=c>9?":"+c+b:":0"+c+b,c=Math.floor(a/60),b=c>9?c+b:"0"+c+b},sizeBToMB:function(a){var a=parseInt(a);return a/=1024,a/=1024,Math.round(100*a)/100>1024?(a/=1024,Math.round(100*a)/100+"GB"):Math.round(100*a)/100+"MB"},getObjectById:function(a){var b,c,d=document.getElementById(a)||null;return d&&"OBJECT"==d.nodeName.toUpperCase()&&("undefined"!=typeof d.SetVariable?b=d:(c=d.getElementsByTagName("embed")[0],c&&(b=c))),b},loadScript:function(a,b,c,d){var e,f,g=document.getElementsByTagName("head")[0];e=document.createElement("script"),e.type="text/javascript",e.onload=e.onreadystatechange=function(){this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(e.onload=e.onreadystatechange=null,f&&clearTimeout(f),b&&b())},e.src=a,g.appendChild(e),f=setTimeout(function(){e.onload=e.onreadystatechange=null,c&&c()},d||8e3)},arrayToJson:function(a){return a.length>0?'"'+a.toString().replace(/\,/g,'","')+'"':""}},clouds.utils.provide("clouds.events.Event"),clouds.events.Event=function(a){this.target=null,this.type=a,this.data=null,this.extraData=null},clouds.events.Event.ERROR="error",clouds.events.Event.COMPLETE="complete",clouds.events.Event.PROGRESS="progress",clouds.events.Event.LOADSTAET="loadstart",clouds.utils.provide("clouds.events.ErrorEvent"),clouds.events.ErrorEvent=function(){clouds.events.Event.apply(this,arguments),this.code=null},clouds.utils.inherits(clouds.events.ErrorEvent,clouds.events.Event),clouds.utils.provide("clouds.events.EventDispatcher"),clouds.events.funList={},clouds.events.uint=0,clouds.events.EventDispatcher=function(){},clouds.events.EventDispatcher.prototype.addEventListener=function(a,b){return clouds.events.uint++,clouds.events.funList[clouds.events.uint]=b,this[a]&&this[a].constructor===Array?this[a].push(clouds.events.uint):this[a]=[clouds.events.uint],clouds.events.uint},clouds.events.EventDispatcher.prototype.dispatchEvent=function(a){var b=this[a.type];if(b)for(var c=0,d=b.length;d>c;c++)clouds.events.funList[b[c]]&&(a.target=this,clouds.events.funList[b[c]].call(this,a))},clouds.events.EventDispatcher.prototype.hasEventListener=function(a){return this[a]?!0:!1},clouds.events.EventDispatcher.prototype.removeEventListener=function(a){for(var b in this[a])delete clouds.events.funList[b];delete this[a]},clouds.events.EventDispatcher.prototype.unlistenByKey=function(a){a in clouds.events.funList&&(clouds.events.funList[a]=null,delete clouds.events.funList[a])},clouds.utils.provide("clouds.ui.Component"),clouds.ui.Component=function(){clouds.events.EventDispatcher.apply(this,arguments)},clouds.utils.inherits(clouds.ui.Component,clouds.events.EventDispatcher),clouds.ui.Component.prototype.log=function(a){},clouds.ui.Component.prototype.decorate=function(a){this.disposeInternal(a),this.enterDocument()},clouds.ui.Component.prototype.release=function(){this.decorateInternal()},clouds.ui.Component.prototype.disposeInternal=function(a){},clouds.ui.Component.prototype.enterDocument=function(){},clouds.ui.Component.prototype.decorateInternal=function(){},clouds.utils.provide("clouds.model.vo.LoaderVo"),clouds.model.vo.LoaderVo=function(a,b,c,d,e,f){this.start=a,this.end=b,this.name=c,this.data=d,this.size=e,this.url=f},clouds.model.vo.LoaderVo.prototype.SetStart=function(a){this.start=a},clouds.model.vo.LoaderVo.prototype.GetStart=function(){return this.start},clouds.model.vo.LoaderVo.prototype.SetEnd=function(a){this.end=a},clouds.model.vo.LoaderVo.prototype.GetEnd=function(){return this.end},clouds.model.vo.LoaderVo.prototype.SetName=function(a){this.name=a},clouds.model.vo.LoaderVo.prototype.GetName=function(){return this.name},clouds.model.vo.LoaderVo.prototype.SetData=function(a){this.data=a},clouds.model.vo.LoaderVo.prototype.GetData=function(){return this.data},clouds.model.vo.LoaderVo.prototype.SetSize=function(a){this.size=a},clouds.model.vo.LoaderVo.prototype.GetSize=function(){return this.size},clouds.model.vo.LoaderVo.prototype.SetUrl=function(a){this.url=a},clouds.model.vo.LoaderVo.prototype.GetUrl=function(){return this.url},clouds.utils.provide("clouds.sdk.base"),clouds.sdk.base.fileid=0,clouds.sdk.base.swfobject=null,clouds.sdk.base.jsCallAs="onJsToaction",clouds.sdk.base.uploadid="cloudsupload",clouds.sdk.base.videosize=4194304,clouds.sdk.base.uploadswf="./html/swf/sdkupload.swf",clouds.sdk.base.htmltpl='<a href="javascript:void(0);" style="display:inline-block;width:{width}px;height:{height}px;line-height:{height}px;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;-o-border-radius:5px;-ms-border-radius:5px;position:relative;background:{background};text-align:center; font-size:14px;font-family:Microsoft YaHei;text-decoration:none;color:{color};overflow: hidden;">{value}<input id="'+clouds.sdk.base.uploadid+'" type="file" multiple="multiple" style="display: inline-block;opacity:0;cursor: pointer;position:absolute; left: -100px; top:0; width:{filewidth}px; height:{height}px;"></a>',clouds.sdk.base.swftpl='<object width="100%" height="100%"  align="middle" id="'+clouds.sdk.base.uploadid+'" type="application/x-shockwave-flash" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"><param name="movie" value="'+clouds.sdk.base.uploadswf+'"><param value="always" name="allowscriptaccess"><param value="true" name="allowfullscreen"><param value="transparent" name="wmode" /><embed width="100%" height="100%" name="'+clouds.sdk.base.uploadid+'" src="'+clouds.sdk.base.uploadswf+'" quality="high"  wmode="transparent" type="application/x-shockwave-flash" allowscriptaccess="always" allowfullscreen="true" /></object>',clouds.sdk.base.uploadtoken="http://access.baofengcloud.com/upload",clouds.sdk.base.delloadtoken="http://access.baofengcloud.com/delete",clouds.sdk.base.skin={width:90,height:30,value:"\u9009\u62e9\u6587\u4ef6",background:"#055cb6",color:"#ffffff"},clouds.sdk.base.config={deltokenurl:"",tokenurl:"",filetype:"",uptype:"1",servicetype:"",delcallbackurl:"",uploadcallbackurl:""},clouds.sdk.base.deleteupvideo="http://www.baofengcloud.com/video/uploaddeletevideo?servicetype={servicetype}&filename={filename}&filekey={filekey}",clouds.sdk.base.videotypes="mp4|mp4v|m4v|flv|f4v|rmvb|rm|mpg|mpeg|mpe|asf|asx|wmv|wm|avi|mov|mkv|3gp|mts|dat|vob|ts".toUpperCase(),clouds.sdk.base.events={FILE_LIST_EVENT:"filelist",COMPLETE_EVENT:"complete"},clouds.sdk.base.onActionlist={},clouds.sdk.base.onActionTojs=function(){var a,b=Array.prototype.slice.call(arguments),c=b.shift(),d=!0;return c in clouds.sdk.base.onActionlist?(a=clouds.sdk.base.onActionlist[c],"Array"==clouds.utils.getType(a)?a[1].apply(a[0],b):a.apply(this,b)):d},clouds.sdk.base.onJsToaction=function(){var a,b=Array.prototype.slice.call(arguments);return a=b.shift(),clouds.sdk.base.swfobject||(clouds.sdk.base.swfobject=clouds.utils.getObjectById(a)),clouds.sdk.base.swfobject?clouds.sdk.base.swfobject[clouds.sdk.base.jsCallAs].apply(clouds.sdk.base.swfobject,b):void 0},clouds.utils.provide("clouds.sdk.loader"),clouds.sdk.loader=function(){clouds.ui.Component.apply(this,arguments),this.loadxhr=null,this.loadervo=null,this.bytesTotal=0,this.bytesLoaded=0,this.startevent=null,this.errorevent=null,this.completeevent=null,this.progressevent=null},clouds.utils.inherits(clouds.sdk.loader,clouds.ui.Component),clouds.sdk.loader.prototype.SetVo=function(a){this.loadervo=a},clouds.sdk.loader.prototype.upload=function(){var a,b;this.loadxhr||(this.loadxhr=new XMLHttpRequest,this.errorevent=new clouds.events.ErrorEvent(clouds.events.Event.ERROR),this.startevent=new clouds.events.Event(clouds.events.Event.LOADSTAET),this.completeevent=new clouds.events.Event(clouds.events.Event.COMPLETE),this.progressevent=new clouds.events.Event(clouds.events.Event.PROGRESS)),this.loadervo&&this.loadxhr.upload?(a=new FileReader,a.readAsBinaryString(this.loadervo.GetData()),a.onload=clouds.utils.bind(function(){this.bindevents(),b="bytes "+this.loadervo.GetStart()+"-"+(this.loadervo.GetEnd()-1)+"/"+this.loadervo.GetSize(),this.loadxhr.withCredentials=!1,this.loadxhr.open("POST",this.loadervo.GetUrl(),!0),this.loadxhr.setRequestHeader("Content-Range",b),this.loadxhr.setRequestHeader("Content-MD5",hex_md5(a.result)),this.loadxhr.setRequestHeader("Content-Type","application/octet-stream"),this.loadxhr.send(this.loadervo.GetData())},this)):(this.errorevent.code=113,this.loaderror(this.errorevent))},clouds.sdk.loader.prototype.unload=function(){this.loadxhr&&(this.loadxhr.abort(),this.errorevent.code=111,this.loaderror(this.errorevent))},clouds.sdk.loader.prototype.loadstart=function(a){this.dispatchEvent(this.startevent)},clouds.sdk.loader.prototype.loaderror=function(a){"data"in a||(this.errorevent.code=112),this.dispatchEvent(this.errorevent)},clouds.sdk.loader.prototype.loadcomplete=function(){4==this.loadxhr.readyState&&(206==this.loadxhr.status||200==this.loadxhr.status?(this.completeevent.data={code:this.loadxhr.status},this.dispatchEvent(this.completeevent)):415==this.loadxhr.status&&(this.errorevent.code=415,this.dispatchEvent(this.errorevent)))},clouds.sdk.loader.prototype.loadprogress=function(a){a.lengthComputable&&(this.bytesTotal=a.total,this.bytesLoaded=a.loaded,this.progressevent.data={bytesTotal:this.bytesTotal,bytesLoaded:this.bytesLoaded},this.dispatchEvent(this.progressevent))},clouds.sdk.loader.prototype.bindevents=function(){this.loadxhr.upload.onloadstart=clouds.utils.bind(this.loadstart,this),this.loadxhr.upload.onprogress=clouds.utils.bind(this.loadprogress,this),this.loadxhr.upload.onerror=clouds.utils.bind(this.loaderror,this),this.loadxhr.onreadystatechange=clouds.utils.bind(this.loadcomplete,this)},clouds.sdk.loader.prototype.decorateInternal=function(){this.loadxhr=null,this.loadervo=null,this.bytesTotal=0,this.bytesLoaded=0,this.startevent=null,this.errorevent=null,this.completeevent=null,this.progressevent=null},clouds.utils.provide("clouds.sdk.filehtml"),clouds.sdk.filehtml=function(){clouds.ui.Component.apply(this,arguments),this.lastsize=0,this.videosize=0,this.videospeed=0,this.sampling=4,this.speeds=null,this.bytesTotal=0,this.bytesLoaded=0,this.videoid=null,this.timeuid=null,this.videoname=null,this.videotype=null,this.curloaded=null,this.videofile=null,this.uploadurl=null,this.videoqueue=null,this.errorevent=null,this.deleteevent=null,this.uploadevent=null,this.progressevent=null,this.fileid=null},clouds.utils.inherits(clouds.sdk.filehtml,clouds.ui.Component),clouds.sdk.filehtml.prototype.SetId=function(a){this.videoid=a},clouds.sdk.filehtml.prototype.GetId=function(){return this.videoid},clouds.sdk.filehtml.prototype.GetName=function(){return this.videoname},clouds.sdk.filehtml.prototype.GetType=function(){return this.videotype},clouds.sdk.filehtml.prototype.GetSize=function(){return this.videosize},clouds.sdk.filehtml.prototype.GetSpeed=function(){return this.videospeed},clouds.sdk.filehtml.prototype.upload=function(){var a,b=clouds.sdk.base.config;-1!=clouds.sdk.base.videotypes.indexOf(this.videotype)?(a={filename:this.videoname,filesize:this.videosize,filetype:b.filetype,uptype:b.uptype,servicetype:b.servicetype,uploadcallbackurl:b.uploadcallbackurl},clouds.utils.createURL(b.tokenurl,a,clouds.utils.bind(this.tokensuccess,this),clouds.utils.bind(this.tokenerror,this))):(this.errorevent.code=116,this.loaderError(this.errorevent))},clouds.sdk.filehtml.prototype.queueupload=function(){this.curloaded=this.videoqueue.shift(),this.curloaded.addEventListener(clouds.events.Event.ERROR,clouds.utils.bind(this.loaderError,this)),this.curloaded.addEventListener(clouds.events.Event.COMPLETE,clouds.utils.bind(this.loaderComplete,this)),this.curloaded.addEventListener(clouds.events.Event.PROGRESS,clouds.utils.bind(this.loaderProgress,this)),this.curloaded.upload()},clouds.sdk.filehtml.prototype.unload=function(){this.curloaded&&(this.timeuid&&clearTimeout(this.timeuid),this.curloaded.unload()),this.deleteUploadVideo()},clouds.sdk.filehtml.prototype.deleteload=function(){this.curloaded&&(this.timeuid&&clearTimeout(this.timeuid),this.curloaded.unload())},clouds.sdk.filehtml.prototype.deleteUploadVideo=function(){var a,b=clouds.sdk.base.config;"deltokenurl"in b?(a={servicetype:b.servicetype,delcallbackurl:b.delcallbackurl,filename:encodeURIComponent(this.videoname)},clouds.utils.createURL(b.deltokenurl,a,clouds.utils.bind(this.deltokensuccess,this),clouds.utils.bind(this.deltokenerror,this))):this.deltokenerror()},clouds.sdk.filehtml.prototype.deltokenerror=function(){this.errorevent.code=117,this.loaderError(this.errorevent)},clouds.sdk.filehtml.prototype.deltokensuccess=function(a){var b=a.token||null;b?clouds.utils.createURL(clouds.sdk.base.delloadtoken,{token:b},clouds.utils.bind(function(a){0==a.status?(this.deleteevent.data={fileid:this.fileid,code:200},this.dispatchEvent(this.deleteevent)):(this.errorevent.code=117,this.loaderError(this.errorevent))},this),clouds.utils.bind(this.deltokenerror,this),"POST"):(this.errorevent.code=117,this.loaderError(this.errorevent))},clouds.sdk.filehtml.prototype.tokenerror=function(){this.errorevent.code=119,this.loaderError(this.errorevent)},clouds.sdk.filehtml.prototype.tokensuccess=function(a){var b=a.token||null;b?clouds.utils.createURL(clouds.sdk.base.uploadtoken,{token:b},clouds.utils.bind(this.uploadsuccess,this),clouds.utils.bind(this.tokenerror,this),"POST"):(this.errorevent.code=119,this.loaderError(this.errorevent))},clouds.sdk.filehtml.prototype.uploadsuccess=function(a){switch(a.status){case 0:case 102:return void("url"in a&&(this.uploadurl=a.url,clouds.utils.ajax(this.uploadurl,null,clouds.utils.bind(this.vidoeslice,this),clouds.utils.bind(function(){this.errorevent.code=119,this.loaderError(this.errorevent)},this),{"Content-Range":"bytes */"+this.videosize})));case 99:this.errorevent.code=99;break;case 101:return this.errorevent.code=101,this.uploadevent.data={fileid:this.fileid,code:101},void this.dispatchEvent(this.uploadevent);case 103:return this.errorevent.code=103,this.uploadevent.data={fileid:this.fileid,code:103},void this.dispatchEvent(this.uploadevent);case 104:this.errorevent.code=104;break;case 105:this.errorevent.code=105;break;default:this.errorevent.code=115}this.loaderError(this.errorevent)},clouds.sdk.filehtml.prototype.loaderError=function(a){this.videoqueue=[],this.dispatchEvent(a)},clouds.sdk.filehtml.prototype.loaderProgress=function(a){this.bytesLoaded=this.bytesTotal+a.data.bytesLoaded,this.progressevent.data={bytesTotal:this.videosize,bytesLoaded:this.bytesLoaded,speed:this.videospeed},this.dispatchEvent(this.progressevent)},clouds.sdk.filehtml.prototype.loaderComplete=function(a){this.videoqueue.length?(this.bytesTotal+=a.target.bytesTotal,this.releaseload(),this.queueupload()):(this.releaseload(),this.uploadevent.data={fileid:this.fileid,code:200},this.dispatchEvent(this.uploadevent))},clouds.sdk.filehtml.prototype.releaseload=function(){this.curloaded&&(this.curloaded.removeEventListener(clouds.events.Event.ERROR),this.curloaded.removeEventListener(clouds.events.Event.COMPLETE),this.curloaded.removeEventListener(clouds.events.Event.PROGRESS),this.curloaded.release(),this.curloaded=null)},clouds.sdk.filehtml.prototype.addqueue=function(a,b){var c,d;c=this.videofile.slice?this.videofile.slice(a,b):this.videofile.webkitSlice?this.videofile.webkitSlice(a,b):this.videofile.mozSlice?this.videofile.mozSlice(a,b):this.videofile,d=new clouds.sdk.loader,d.SetVo(new clouds.model.vo.LoaderVo(a,b,this.videoname,c,this.videosize,this.uploadurl)),this.videoqueue.push(d)},clouds.sdk.filehtml.prototype.vidoeslice=function(a){var b,c=0,d=0;if(a=JSON.parse(a),a&&a.length)for(var e=0,f=a.length;f>e;e++)if(0==a[e].beg){this.bytesTotal=d=a[e].end;break}for(b=Math.floor((this.videosize-d)/clouds.sdk.base.videosize),e=0;b>e;e++)c=d+clouds.sdk.base.videosize,this.addqueue(d,c),d=c;this.videosize>c&&this.addqueue(d,this.videosize),this.speeds=[],this.uploadTimeout(),this.queueupload()},clouds.sdk.filehtml.prototype.uploadTimeout=function(){var a=0,b=this.speeds.length;this.timeuid&&clearTimeout(this.timeuid),b>this.sampling&&(b-=1,this.speeds.shift()),this.speeds.push(this.bytesLoaded-this.lastsize),b+=1;for(var c=0;b>c;c++)a+=this.speeds[c];this.videospeed=a/b,this.lastsize=this.bytesLoaded,this.timeuid=setTimeout(clouds.utils.bind(this.uploadTimeout,this),800)},clouds.sdk.filehtml.prototype.noticeMessage=function(a){},clouds.sdk.filehtml.prototype.disposeInternal=function(a){this.videofile=a,this.videosize=a.size,this.videoname=a.name,this.videotype=this.videoname.split(".").pop().toUpperCase(),this.videoqueue=[]},clouds.sdk.filehtml.prototype.enterDocument=function(){this.errorevent=new clouds.events.ErrorEvent(clouds.events.Event.ERROR),this.uploadevent=new clouds.events.Event("uploadcomplete"),this.deleteevent=new clouds.events.Event("deletecomplete"),this.progressevent=new clouds.events.Event(clouds.events.Event.PROGRESS)},clouds.sdk.filehtml.prototype.decorateInternal=function(){this.releaseload(),this.timeuid&&clearTimeout(this.timeuid),this.videosize=0,this.lastsize=0,this.videospeed=0,this.speeds=null,this.bytesTotal=0,this.bytesLoaded=0,this.timeuid=null,this.videoid=null,this.videoname=null,this.videotype=null,this.videofile=null,this.uploadurl=null,this.videoqueue=null,this.errorevent=null,this.uploadevent=null,this.deleteevent=null,this.progressevent=null},clouds.utils.provide("clouds.sdk.fileswf"),clouds.sdk.fileswf=function(){clouds.ui.Component.apply(this,arguments),this.videoname=null,this.videotype=null,this.videosize=null,this.errorevent=null,this.deleteevent=null,this.uploadevent=null,this.progressevent=null,this.fileid=null},clouds.utils.inherits(clouds.sdk.fileswf,clouds.ui.Component),clouds.sdk.fileswf.prototype.GetId=function(){return this.fileid},clouds.sdk.fileswf.prototype.GetName=function(){return this.videoname},clouds.sdk.fileswf.prototype.GetType=function(){return this.videotype},clouds.sdk.fileswf.prototype.GetSize=function(){return this.videosize},clouds.sdk.fileswf.prototype.upload=function(){clouds.sdk.base.onJsToaction(clouds.sdk.base.uploadid,"SetLoad",this.fileid)},clouds.sdk.fileswf.prototype.unload=function(){clouds.sdk.base.onJsToaction(clouds.sdk.base.uploadid,"SetUnload",this.fileid)},clouds.sdk.fileswf.prototype.deleteload=function(){clouds.sdk.base.onJsToaction(clouds.sdk.base.uploadid,"SetDelload",this.fileid)},clouds.sdk.fileswf.prototype.deletecallback=function(a){this.dispatchEvent(this.deleteevent)},clouds.sdk.fileswf.prototype.uploadcallback=function(a){this.dispatchEvent(this.uploadevent)},clouds.sdk.fileswf.prototype.progresscallback=function(a){this.progressevent.data=a,this.dispatchEvent(this.progressevent)},clouds.sdk.fileswf.prototype.errorcallback=function(a){this.errorevent.code=a.code,this.dispatchEvent(error)},clouds.sdk.fileswf.prototype.disposeInternal=function(a){this.videosize=a.size,this.videoname=a.name,this.fileid=a.id,this.videotype=this.videoname.split(".").pop().toUpperCase()},clouds.sdk.fileswf.prototype.enterDocument=function(){this.errorevent=new clouds.events.ErrorEvent(clouds.events.Event.ERROR),this.uploadevent=new clouds.events.Event("uploadcomplete"),this.deleteevent=new clouds.events.Event("deletecomplete"),this.progressevent=new clouds.events.Event(clouds.events.Event.PROGRESS)},clouds.sdk.fileswf.prototype.decorateInternal=function(){this.videoname=null,this.videotype=null,this.videosize=null,this.errorevent=null,this.deleteevent=null,this.uploadevent=null,this.progressevent=null,this.fileid=null},clouds.utils.provide("clouds.sdk.swfupload"),clouds.sdk.swfupload=function(){clouds.ui.Component.apply(this,arguments),this.mapdb={}},clouds.utils.inherits(clouds.sdk.swfupload,clouds.ui.Component),clouds.sdk.swfupload.prototype.startdrop=function(a){for(var b,c=[],d=a,e=0,f=d.length;f>e;e++)b=new clouds.sdk.fileswf,b.decorate(d[e]),c.push(b),this.mapdb[d[e].id]=b;this.ListEvent.data=c,this.dispatchEvent(this.ListEvent)},clouds.sdk.swfupload.prototype.swfcomplete=function(a){clouds.sdk.base.onJsToaction(clouds.sdk.base.uploadid,"SetConfig",clouds.sdk.base.config,clouds.sdk.base.skin)},clouds.sdk.swfupload.prototype.deletecallback=function(a){var b,c=a.id;this.mapdb[c]&&(b=this.mapdb[c],b.deletecallback())},clouds.sdk.swfupload.prototype.uploadcallback=function(a){var b,c=a.id;this.mapdb[c]&&(b=this.mapdb[c],b.uploadcallback())},clouds.sdk.swfupload.prototype.progresscallback=function(a){var b,c=a.id;this.mapdb[c]&&(b=this.mapdb[c],b.progresscallback(a))},clouds.sdk.swfupload.prototype.errorcallback=function(a){var b,c=a.id;this.mapdb[c]&&(b=this.mapdb[c],b.errorcallback(a))},clouds.sdk.swfupload.prototype.disposeInternal=function(a){this.element=a,this.element.innerHTML=clouds.sdk.base.swftpl,this.uploadbutton=clouds.utils.getSwf(clouds.sdk.base.uploadid),this.ListEvent=new clouds.events.Event(clouds.sdk.base.events.FILE_LIST_EVENT)},clouds.sdk.swfupload.prototype.enterDocument=function(){clouds.sdk.base.onActionlist[clouds.sdk.base.events.FILE_LIST_EVENT]=clouds.utils.bind(this.startdrop,this),clouds.sdk.base.onActionlist[clouds.sdk.base.events.COMPLETE_EVENT]=clouds.utils.bind(this.swfcomplete,this),clouds.sdk.base.onActionlist.deletecomplete=clouds.utils.bind(this.deletecallback,this),clouds.sdk.base.onActionlist.uploadcomplete=clouds.utils.bind(this.uploadcallback,this),clouds.sdk.base.onActionlist.uploadprogress=clouds.utils.bind(this.progresscallback,this),clouds.sdk.base.onActionlist.uploaderror=clouds.utils.bind(this.errorcallback,this);
},clouds.sdk.swfupload.prototype.decorateInternal=function(){},clouds.utils.provide("clouds.sdk.htmlupload"),clouds.sdk.htmlupload=function(){clouds.ui.Component.apply(this,arguments),this.element=null,this.uploadbutton=null,this.ListEvent=null},clouds.utils.inherits(clouds.sdk.htmlupload,clouds.ui.Component),clouds.sdk.htmlupload.prototype.startdrop=function(a){for(var b,c=[],d=a.target.files||a.dataTransfer.files,e=0,f=d.length;f>e;e++)b=new clouds.sdk.filehtml,b.fileid=clouds.sdk.base.fileid,clouds.sdk.base.fileid++,b.decorate(d[e]),c.push(b);this.ListEvent.data=c,this.dispatchEvent(this.ListEvent),a.stopPropagation(),a.preventDefault()},clouds.sdk.htmlupload.prototype.stopdrag=function(a){a.stopPropagation(),a.preventDefault()},clouds.sdk.htmlupload.prototype.assemblefileloader=function(a){a.stopPropagation(),a.preventDefault()},clouds.sdk.htmlupload.prototype.disposeInternal=function(a){this.element=a,clouds.sdk.base.skin.filewidth=clouds.sdk.base.skin.width+100,this.element.innerHTML=clouds.utils.analyzetpl(clouds.sdk.base.htmltpl,clouds.sdk.base.skin),this.uploadbutton=document.getElementById(clouds.sdk.base.uploadid),this.ListEvent=new clouds.events.Event(clouds.sdk.base.events.FILE_LIST_EVENT)},clouds.sdk.htmlupload.prototype.enterDocument=function(){document.addEventListener("drop",clouds.utils.bind(this.startdrop,this),!1),document.addEventListener("dragover",clouds.utils.bind(this.stopdrag,this),!1),document.addEventListener("dragleave",clouds.utils.bind(this.stopdrag,this),!1),this.uploadbutton.onchange=clouds.utils.bind(this.startdrop,this)},clouds.sdk.htmlupload.prototype.decorateInternal=function(){},function(a){function b(){return window.ActiveXObject||"ActiveXObject"in window?!0:!1}function c(b){var c=!0;for(var d in a.sdk.base.config)if(""===a.sdk.base.config[d]){c=!1;break}return c}var d,e=a.uploadsdk||function(){a.ui.Component.apply(this,arguments)};a.utils.inherits(e,a.ui.Component),e.prototype.SetSkin=function(b){for(var c in a.sdk.base.skin)c in b&&(a.sdk.base.skin[c]=b[c])},e.prototype.SetConfig=function(b){"tokenurl"in b&&(b.tokenurl=b.tokenurl+"?filename={filename}&filesize={filesize}&filekey={filekey}&filetype={filetype}&uptype={uptype}&servicetype={servicetype}&callbackurl={uploadcallbackurl}"),"deltokenurl"in b?b.deltokenurl=b.deltokenurl+"?filename={filename}&servicetype={servicetype}&filekey={filekey}&callbackurl={delcallbackurl}":(delete a.sdk.base.config.deltokenurl,delete a.sdk.base.config.delcallbackurl);for(var c in a.sdk.base.config)c in b&&(a.sdk.base.config[c]=b[c])},e.prototype.distribution=function(a){this.dispatchEvent(a)},e.prototype.disposeInternal=function(e){var f=document.getElementById(e);f&&c(a.sdk.base.config)?(b()||"undefined"==typeof FileReader||"undefined"==typeof XMLHttpRequest?(a.sdk.base.config.uptype=0,d=new a.sdk.swfupload):d=new a.sdk.htmlupload,d.decorate(f)):alert("\u8bf7\u586b\u5199\u5168\u90e8\u914d\u7f6e\u53c2\u6570")},e.prototype.enterDocument=function(){d&&d.addEventListener(a.sdk.base.events.FILE_LIST_EVENT,a.utils.bind(this.distribution,this))},a.uploadsdk=new e}("object"==typeof clouds?clouds:window);
//# sourceMappingURL=map/uploadsdk.min.map